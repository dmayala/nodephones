define(["backbone","hbs!templates/cartTpl","models/cbbutton","views/cbbutton"],function(e,t,n,r){var i=e.View.extend({template:t,initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},events:{"click .remove":"deleteUnit","click .update":"updateUnit"},deleteUnit:function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-index");this.model.get("items").splice(t,1),this.model.save(),this.model.trigger("change")},updateUnit:function(e){e.preventDefault();var t=$(e.currentTarget).attr("data-index");this.model.get("items")[t].qty=$(e.currentTarget).closest("tr").find("input").val(),this.model.save()},button:function(){var e=new n;e.fetch({success:function(){$("#payup").html((new r({model:e})).el)}})},render:function(){return this.$el.html(this.template(this.model.attributes)),this.model.attributes.items.length&&this.button(),this}});return i});